<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ¸¸æˆè´¦å·ä¼°å€¼å™¨ - ä¼°ä»·æŒ‘æˆ˜èµ›</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #FFD700;
            --primary-dark: #FFA500;
            --bg-dark: #1a1a2e;
            --bg-card: #16213e;
            --text-light: #ffffff;
            --text-gray: #a0a0a0;
            --success: #00C853;
            --warning: #FFC107;
            --danger: #FF5252;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: var(--bg-dark);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .page {
            display: none;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Home Page */
        .home-hero {
            text-align: center;
            padding: 40px 20px;
        }
        
        .game-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }
        
        .home-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--primary), #FF6B6B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .home-subtitle {
            color: var(--text-gray);
            font-size: 14px;
            margin-bottom: 40px;
        }
        
        .challenge-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .challenge-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .challenge-desc {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .stats-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
        }
        
        .btn {
            display: block;
            width: 100%;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #1a1a2e;
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: var(--text-light);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        /* Game Selection */
        .game-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .game-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        .game-card:hover, .game-card.selected {
            border-color: var(--primary);
            transform: translateY(-2px);
        }
        
        .game-card-icon {
            width: 60px;
            height: 60px;
            border-radius: 14px;
            margin: 0 auto 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }
        
        .game-card-name {
            font-size: 14px;
            font-weight: 600;
        }
        
        /* PK Page */
        .pk-header {
            text-align: center;
            padding: 20px 0;
        }
        
        .pk-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .pk-subtitle {
            color: var(--text-gray);
            font-size: 13px;
        }
        
        .reward-table {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .reward-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .reward-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 13px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .reward-row:last-child {
            border-bottom: none;
        }
        
        .reward-badge {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .input-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .input-label {
            font-size: 15px;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .price-input-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .price-prefix {
            font-size: 24px;
            color: var(--primary);
            margin-right: 8px;
        }
        
        .price-input {
            width: 160px;
            padding: 15px;
            font-size: 28px;
            text-align: center;
            border: 2px solid var(--primary);
            border-radius: 12px;
            background: transparent;
            color: var(--text-light);
            outline: none;
        }
        
        .price-suffix {
            font-size: 24px;
            color: var(--primary);
            margin-left: 8px;
        }
        
        .tip-text {
            text-align: center;
            color: var(--text-gray);
            font-size: 12px;
        }
        
        /* Result Page */
        .result-container {
            text-align: center;
            padding: 30px 0;
        }
        
        .result-emoji {
            font-size: 60px;
            margin-bottom: 20px;
        }
        
        .result-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 30px;
        }
        
        .result-card {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .result-prices {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .result-price-item {
            text-align: center;
        }
        
        .result-price-label {
            font-size: 12px;
            color: var(--text-gray);
            margin-bottom: 8px;
        }
        
        .result-price-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .result-diff {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .result-coupon {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #1a1a2e;
            padding: 20px;
            border-radius: 12px;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .analysis-text {
            color: var(--text-gray);
            font-size: 13px;
            line-height: 1.6;
            margin: 20px 0;
        }
        
        .divider {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        
        .divider-line {
            flex: 1;
            height: 1px;
            background: rgba(255,255,255,0.1);
        }
        
        .divider-text {
            padding: 0 15px;
            color: var(--text-gray);
            font-size: 12px;
        }
        
        /* Precision Form */
        .form-section {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
        }
        
        .form-label {
            font-size: 13px;
            color: var(--text-gray);
            margin-bottom: 8px;
        }
        
        .form-options {
            display: flex;
            gap: 10px;
        }
        
        .form-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }
        
        .form-option.selected {
            border-color: var(--primary);
            background: rgba(255,215,0,0.1);
        }
        
        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: transparent;
            color: var(--text-light);
            font-size: 14px;
            outline: none;
        }
        
        .form-input:focus {
            border-color: var(--primary);
        }
        
        .phone-note {
            font-size: 11px;
            color: var(--text-gray);
            margin-top: 8px;
        }
        
        /* Share Page */
        .share-container {
            text-align: center;
            padding: 30px 0;
        }
        
        .share-card {
            background: linear-gradient(135deg, #1a1a2e 0%, #2d2d44 100%);
            border-radius: 20px;
            padding: 30px 20px;
            margin: 20px 0;
        }
        
        .share-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .share-result {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .share-result-item {
            text-align: center;
        }
        
        .share-result-label {
            font-size: 12px;
            color: var(--text-gray);
            margin-bottom: 5px;
        }
        
        .share-result-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .share-coupon {
            background: rgba(255,215,0,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .qr-section {
            margin: 30px 0;
        }
        
        .qr-image {
            width: 150px;
            height: 150px;
            margin: 0 auto 15px;
            border-radius: 10px;
        }
        
        .qr-tip {
            font-size: 12px;
            color: var(--text-gray);
        }
        
        .share-btns {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .share-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .share-btn-save {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: #1a1a2e;
        }
        
        .share-btn-share {
            background: rgba(255,255,255,0.1);
            color: var(--text-light);
        }
        
        /* Precision Result */
        .precision-result-card {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
        }
        
        .precision-price {
            font-size: 36px;
            font-weight: bold;
            color: var(--primary);
            text-align: center;
            margin: 20px 0;
        }
        
        .precision-note {
            text-align: center;
            color: var(--text-gray);
            font-size: 13px;
            margin-bottom: 20px;
        }
        
        .detail-list {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            font-size: 13px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .detail-item:last-child {
            border-bottom: none;
        }
        
        .contact-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-top: 20px;
        }
        
        .contact-title {
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        /* Toast */
        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 20px 30px;
            border-radius: 12px;
            font-size: 14px;
            z-index: 1000;
            display: none;
            animation: toastIn 0.3s ease;
        }
        
        .toast.show {
            display: block;
        }
        
        @keyframes toastIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
        
        /* Hidden canvas for share */
        #shareCanvas {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Page 1: Home -->
    <div id="page-home" class="page active">
        <div class="home-hero">
            <div class="game-icon" style="background: linear-gradient(135deg, #FFD700, #FF6B6B);">ğŸ®</div>
            <h1 class="home-title">æ¸¸æˆè´¦å·ä¼°å€¼å™¨</h1>
            <p class="home-subtitle">ä¸“ä¸šä¼°ä»· Â· å¿«é€Ÿæˆäº¤ Â· å®‰å…¨æ— å¿§</p>
            
            <div class="challenge-card">
                <h2 class="challenge-title">ğŸ’° ä¼°ä»·æŒ‘æˆ˜èµ›</h2>
                <p class="challenge-desc">çŒœä¸­AIä¼°ä»·ï¼Œé¢†å–æ— é—¨æ§›åˆ¸ï¼<br>çŒœå¾—è¶Šå‡†ï¼Œå¥–åŠ±è¶Šå¤š</p>
                <span class="stats-badge">å·²æœ‰ <span id="total-participants">12,345</span> äººå‚ä¸</span>
            </div>
            
            <button class="btn btn-primary" onclick="goToGameSelect()">ç«‹å³æŒ‘æˆ˜</button>
            <button class="btn btn-secondary" onclick="goToPrecisionForm()">ç²¾å‡†ä¼°ä»·</button>
        </div>
    </div>
    
    <!-- Page 2: Game Selection -->
    <div id="page-game" class="page">
        <div class="pk-header">
            <h2 class="pk-title">é€‰æ‹©æ¸¸æˆ</h2>
            <p class="pk-subtitle">å¼€å§‹ä¼°ä»·æŒ‘æˆ˜</p>
        </div>
        
        <div class="game-grid">
            <div class="game-card" onclick="selectGame('wangzhe')">
                <div class="game-card-icon" style="background: linear-gradient(135deg, #FFD700, #FF8C00);">ğŸ‘‘</div>
                <div class="game-card-name">ç‹è€…è£è€€</div>
            </div>
            <div class="game-card" onclick="selectGame('heping')">
                <div class="game-card-icon" style="background: linear-gradient(13500);">ğŸ®</div>
                <div class="game-card-name">å’Œå¹³ç²¾è‹±</div>
            </div>
            <div class="game-card" onclick="selectGame('sanjiao')">
                <div class="game-card-icon" style="background: linear-gradient(135deg, #4a5568, #2d3748);">ğŸ¦…</div>
                <div class="game-card-name">ä¸‰è§’æ´²è¡ŒåŠ¨</div>
            </div>
            <div class="game-card" onclick="selectGame('heping')">
                <div class="game-card-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);"></div>
                <div class="game-card-name">æ›´å¤šæ¸¸æˆ</div>
            </div>
        </div>
    </div>
    
    <!-- Page 3: PK Game -->
    <div id="page-pk" class="page">
        <div class="pk-header">
            <h2 class="pk-title">ğŸ’° ä¼°ä»·æŒ‘æˆ˜èµ›</h2>
            <p class="pk-subtitle">çŒœä¸­AIä¼°ä»·ï¼Œé¢†å–æ— é—¨æ§›åˆ¸</p>
        </div>
        
        <div class="reward-table">
            <div class="reward-title">ğŸ† å¥–åŠ±è§„åˆ™</div>
            <div class="reward-row">
                <span>å·®å¼‚ â‰¤ 5%</span>
                <span class="reward-badge" style="background: #FFD700; color: #1a1a2e;">50å…ƒåˆ¸</span>
            </div>
            <div class="reward-row">
                <span>å·®å¼‚ â‰¤ 10%</span>
                <span class="reward-badge" style="background: #FFA726; color: #1a1a2e;">30å…ƒåˆ¸</span>
            </div>
            <div class="reward-row">
                <span>å·®å¼‚ â‰¤ 20%</span>
                <span class="reward-badge" style="background: #FFB74D; color: #1a1a2e;">20å…ƒåˆ¸</span>
            </div>
            <div class="reward-row">
                <span>å·®å¼‚ â‰¤ 30%</span>
                <span class="reward-badge" style="background: #FFCC80; color: #1a1a2e;">10å…ƒåˆ¸</span>
            </div>
            <div class="reward-row">
                <span>å·®å¼‚ > 30%</span>
                <span class="reward-badge" style="background: #FFE0B2; color: #1a1a2e;">5å…ƒåˆ¸</span>
            </div>
        </div>
        
        <div class="input-section" id="account-info" style="margin-bottom: 20px; text-align: center;">
                <p class="input-label" style="font-size: 14px; color: var(--text-gray);">ğŸ“‹ è´¦å·ä¿¡æ¯</p>
                <div id="sample-account" style="background: rgba(255,215,0,0.1); padding: 15px; border-radius: 10px; margin: 10px 0;">
                    <p id="account-desc" style="font-size: 14px; color: var(--text-light); line-height: 1.8;"></p>
                </div>
            </div>
            
            <div class="input-section" style="margin-top: 20px;">
            <p class="input-label">ä½ è§‰å¾—è¿™ä¸ªè´¦å·å€¼å¤šå°‘ï¼Ÿ</p>
            <div class="price-input-wrapper">
                <span class="price-prefix">Â¥</span>
                <input type="number" class="price-input" id="user-price" placeholder="0" />
                <span class="price-suffix">å…ƒ</span>
            </div>
            <p class="tip-text">æç¤ºï¼šå®é™…ä»·å€¼åœ¨ Â¥<span id="price-range">500 - 2000</span> ä¹‹é—´</p>
        </div>
        
        <button class="btn btn-primary" onclick="submitPK()">æäº¤ä¼°ä»·</button>
        
        <p style="text-align: center; color: var(--text-gray); font-size: 12px; margin-top: 20px;">
            å·²æœ‰ <span id="pk-participants">8,888</span> äººå‚ä¸
        </p>
    </div>
    
    <!-- Page 4: Result -->
    <div id="page-result" class="page">
        <div class="result-container">
            <div id="result-emoji" class="result-emoji">ğŸ‰</div>
            <h2 id="result-title" class="result-title">å¤ªå‡†äº†ï¼</h2>
            
            <div class="result-card">
                <div class="result-prices">
                    <div class="result-price-item">
                        <div class="result-price-label">ä½ çš„ä¼°ä»·</div>
                        <div id="result-user" class="result-price-value">Â¥1,200</div>
                    </div>
                    <div class="result-price-item">
                        <div class="result-price-label">AIä¼°ä»·</div>
                        <div id="result-ai" class="result-price-value">Â¥1,188</div>
                    </div>
                </div>
                
                <div id="result-diff-badge" class="result-diff">å·®å¼‚ï¼š1.0%</div>
                
                <div id="result-coupon" class="result-coupon">ğŸ 50å…ƒæ— é—¨æ§›åˆ¸</div>
            </div>
            
            <p id="analysis-text" class="analysis-text">ä½ çš„ä¼°ä»·èƒ½åŠ›è¶…è¶Šäº†99%çš„ç©å®¶ï¼</p>
            
            <div class="divider">
                <div class="divider-line"></div>
                <span class="divider-text">æˆ–è€…</span>
                <div class="divider-line"></div>
            </div>
            
            <button class="btn btn-secondary" onclick="goToPrecisionForm()">ğŸ” è·å–æ›´ç²¾å‡†ä¼°ä»·</button>
            <button class="btn btn-primary" onclick="goToShare()">ğŸ¨ ç”Ÿæˆåˆ†äº«æµ·æŠ¥</button>
        </div>
    </div>
    
    <!-- Page 5: Precision Form -->
    <div id="page-precision" class="page">
        <div class="pk-header">
            <h2 class="pk-title">ğŸ” è·å–ç²¾å‡†ä¼°ä»·</h2>
            <p class="pk-subtitle">å¡«å†™è¯¦ç»†ä¿¡æ¯ï¼Œè·å–å‡†ç¡®æŠ¥ä»·</p>
        </div>
        
        <form id="precision-form">
            <div id="game-fields">
                <!-- Dynamic game fields will be inserted here -->
            </div>
            
            <div class="form-section">
                <div class="form-label">ğŸ“± æ‰‹æœºå·ï¼ˆå¿…å¡«ï¼‰</div>
                <input type="tel" class="form-input" id="phone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" required />
                <p class="phone-note">ç”¨äºæ¥æ”¶ä¼°ä»·ç»“æœå’Œä¼˜æƒ åˆ¸</p>
            </div>
            
            <button type="button" class="btn btn-primary" onclick="submitPrecision()">æäº¤è·å–ç²¾å‡†æŠ¥ä»·</button>
        </form>
    </div>
    
    <!-- Page 6: Precision Result -->
    <div id="page-precision-result" class="page">
        <div class="result-container">
            <div class="result-emoji">ğŸ‰</div>
            <h2 class="result-title">ç²¾å‡†ä¼°ä»·å·²ç”Ÿæˆ</h2>
            
            <div class="precision-result-card">
                <p>ä½ çš„è´¦å·é¢„ä¼°ä»·å€¼</p>
                <div id="precision-price" class="precision-price">Â¥1,000 - 1,200</div>
                <p id="precision-sent" class="precision-note">ä¼°ä»·å·²å‘é€è‡³ 1XXXXXXXXXX</p>
                
                <div class="detail-list" id="precision-details">
                    <!-- Details will be inserted here -->
                </div>
            </div>
            
            <div class="contact-card">
                <p class="contact-title">ğŸ“± å®¢æœå°†è”ç³»ä½ </p>
                <p style="font-size: 12px; opacity: 0.8;">è¿›è¡ŒéªŒå·å’Œäº¤æ˜“å¯¹æ¥</p>
            </div>
            
            <button class="btn btn-primary" onclick="goToHome()">è¿”å›é¦–é¡µ</button>
        </div>
    </div>
    
    <!-- Page 7: Share -->
    <div id="page-share" class="page">
        <div class="share-container">
            <div class="share-card">
                <h3 class="share-title">ğŸ† ä¼°ä»·æŒ‘æˆ˜èµ›</h3>
                
                <div class="share-result">
                    <div class="share-result-item">
                        <div class="share-result-label">æˆ‘çš„ä¼°ä»·</div>
                        <div id="share-user" class="share-result-value">Â¥1,200</div>
                    </div>
                    <div class="share-result-item">
                        <div class="share-result-label">AIä¼°ä»·</div>
                        <div id="share-ai" class="share-result-value">Â¥1,188</div>
                    </div>
                </div>
                
                <div id="share-coupon" class="share-coupon">
                    ğŸ å·®å¼‚1.0% è·å¾— 50å…ƒåˆ¸
                </div>
                
                <div class="qr-section">
                    <img id="qr-image" class="qr-image" src="" alt="å®¢æœäºŒç»´ç " />
                    <p class="qr-tip">é•¿æŒ‰è¯†åˆ«äºŒç»´ç  Â· ä¸€èµ·æŒ‘æˆ˜é¢†åˆ¸</p>
                </div>
            </div>
            
            <div class="share-btns">
                <button class="share-btn share-btn-save" onclick="saveShareImage()">ğŸ’¾ ä¿å­˜å›¾ç‰‡</button>
                <button class="share-btn share-btn-share" onclick="shareToFriend()">ğŸ“¤ åˆ†äº«ç»™å¥½å‹</button>
            </div>
            
            <button class="btn btn-secondary" style="margin-top: 20px;" onclick="goToHome()">è¿”å›é¦–é¡µ</button>
        </div>
    </div>
    
    <!-- Toast -->
    <div id="toast" class="toast">ä¿å­˜æˆåŠŸ</div>
    
    <!-- Hidden canvas for generating share image -->
    <canvas id="shareCanvas" width="375" height="600"></canvas>

    <script>
        // Global state
        let currentGame = '';
        let currentSample = {};
        let pkResult = {};
        let precisionResult = {};
        let participants = 12345;
        
        // Game field templates
        const gameFields = {
            wangzhe: `
                <div class="form-section">
                    <div class="form-label">æ¸¸æˆåŒºæœ</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'zone', 'QåŒº')">QåŒº</div>
                        <div class="form-option" onclick="selectOption(this, 'zone', 'VåŒº')">VåŒº</div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">è´µæ—ç­‰çº§</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'vip', 'V0-V9')">V0-V9</div>
                        <div class="form-option" onclick="selectOption(this, 'vip', 'V10')">V10</div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">çš®è‚¤æ•°é‡</div>
                    <input type="number" class="form-input" id="skin-count" placeholder="è¯·è¾“å…¥çš®è‚¤æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">çå“ä¼ è¯´æ•°é‡</div>
                    <input type="number" class="form-input" id="legend-count" placeholder="è¯·è¾“å…¥ä¼ è¯´æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">çå“æ— åŒ/å…¸è—æ•°é‡</div>
                    <input type="number" class="form-input" id="epic-count" placeholder="è¯·è¾“å…¥æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">æ˜¯å¦ä¸ºå¥³ç”Ÿå·</div>
                    <div class="form-options">
                        <div class="form-option" onclick="selectOption(this, 'girl', 'æ˜¯')">æ˜¯</div>
                        <div class="form-option selected" onclick="selectOption(this, 'girl', 'å¦')">å¦</div>
                    </div>
                </div>
            `,
            heping: `
                <div class="form-section">
                    <div class="form-label">è´¦å·æ˜¯å¦æœ‰äºŒæ¬¡</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'second', 'æœ‰')">æœ‰</div>
                        <div class="form-option" onclick="selectOption(this, 'second', 'æ— ')">æ— </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">ç²‰è‰²å¥—è£…æ•°é‡</div>
                    <input type="number" class="form-input" id="pink-count" placeholder="è¯·è¾“å…¥æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">ç‰¹æ•ˆæªæ•°é‡</div>
                    <input type="number" class="form-input" id="gun-count" placeholder="è¯·è¾“å…¥æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">è½½å…·ç±»å‹</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'car', 'æ™®é€š')">æ™®é€š</div>
                        <div class="form-option" onclick="selectOption(this, 'car', 'çº¢è¹¦è¹¦')">çº¢è¹¦è¹¦</div>
                        <div class="form-option" onclick="selectOption(this, 'car', 'äº”çº§è½¦')">äº”çº§è½¦</div>
                        <div class="form-option" onclick="selectOption(this, 'car', 'æ»¡çº§è½¦')">æ»¡çº§è½¦</div>
                    </div>
                </div>
            `,
            sanjiao: `
                <div class="form-section">
                    <div class="form-label">çƒ½ç«ç­‰çº§</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'level', '40+')">40çº§ä»¥ä¸Š</div>
                        <div class="form-option" onclick="selectOption(this, 'level', '40-')">40çº§ä»¥ä¸‹</div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">èµ„äº§ï¼ˆä¸‡è´§å¸ï¼‰</div>
                    <input type="number" class="form-input" id="asset" placeholder="è¯·è¾“å…¥èµ„äº§æ•°é‡" />
                </div>
                <div class="form-section">
                    <div class="form-label">æ˜¯å¦æœ‰æªçš®</div>
                    <div class="form-options">
                        <div class="form-option" onclick="selectOption(this, 'gunskin', 'æœ‰')">æœ‰</div>
                        <div class="form-option selected" onclick="selectOption(this, 'gunskin', 'æ— ')">æ— </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">æ˜¯å¦æœ‰è‹±é›„çš®è‚¤</div>
                    <div class="form-options" id="hero-skins">
                        <div class="form-option" onclick="toggleHeroSkin(this, 'æ°´å¢¨äº‘å›¾')">æ°´å¢¨äº‘å›¾</div>
                        <div class="form-option" onclick="toggleHeroSkin(this, 'èš€é‡‘ç«ç‘°')">èš€é‡‘ç«ç‘°</div>
                        <div class="form-option" onclick="toggleHeroSkin(this, 'é£è™å¨é¾™')">é£è™å¨é¾™</div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="form-label">æ˜¯å¦æœ‰å°å·è®°å½•</div>
                    <div class="form-options">
                        <div class="form-option selected" onclick="selectOption(this, 'ban', 'æ— ')">æ— </div>
                        <div class="form-option" onclick="selectOption(this, 'ban', 'æœ‰')">æœ‰</div>
                    </div>
                </div>
            `
        };
        
        // Sample accounts for PK game
        const samples = {
            wangzhe: [
                { price: 888, desc: 'V8 | 188çš®è‚¤ | 18ä¼ è¯´' },
                { price: 1588, desc: 'V10 | 280çš®è‚¤ | 28ä¼ è¯´ | 2æ— åŒ' },
                { price: 688, desc: 'V6 | 120çš®è‚¤ | 8ä¼ è¯´' },
                { price: 2888, desc: 'V10æ»¡ | 400+çš®è‚¤ | 50ä¼ è¯´ | 5å…¸è—' },
                { price: 1288, desc: 'V9 | 200çš®è‚¤ | 15ä¼ è¯´ | 1æ— åŒ' },
                { price: 3888, desc: 'V10æ»¡ | 500çš®è‚¤ | 80ä¼ è¯´ | 8å…¸è—' },
                { price: 588, desc: 'V5 | 80çš®è‚¤ | 5ä¼ è¯´' },
                { price: 2188, desc: 'V10 | 350çš®è‚¤ | 35ä¼ è¯´ | 3æ— åŒ' }
            ],
            heping: [
                { price: 688, desc: 'åŸºç¡€å· | 1ç²‰è‰² | 2ç‰¹æ•ˆæª' },
                { price: 1588, desc: 'æ— äºŒæ¬¡ | 3ç²‰è‰² | 5ç‰¹æ•ˆæª | çº¢è¹¦è¹¦' },
                { price: 888, desc: '1000å†… | 2ç²‰è‰² | 3ç‰¹æ•ˆæª' },
                { price: 2888, desc: 'æ»¡çº§è½¦ | 5ç²‰è‰² | 10ç‰¹æ•ˆæª' },
                { price: 488, desc: 'åŸºç¡€å· | 1ç²‰è‰² | 1ç‰¹æ•ˆæª' },
                { price: 2188, desc: 'æ— äºŒæ¬¡8æŠ˜ | 4ç²‰è‰² | 6ç‰¹æ•ˆæª | äº”çº§è½¦' }
            ],
            sanjiao: [
                { price: 588, desc: '40çº§ | 100mèµ„äº§ | æ— æªçš®' },
                { price: 1288, desc: '45çº§ | 300mèµ„äº§ | 1æªçš®' },
                { price: 888, desc: '42çº§ | 200mèµ„äº§ | æ°´å¢¨äº‘å›¾' },
                { price: 1888, desc: '50çº§ | 500mèµ„äº§ | 1æªçš® | èš€é‡‘ç«ç‘°' },
                { price: 688, desc: '38çº§ | 150mèµ„äº§ | æ— ç‰¹æ®Š' }
            ]
        };
        
        // Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }
        
        function goToGameSelect() {
            showPage('page-game');
        }
        
        function goToHome() {
            participants++;
            document.getElementById('total-participants').textContent = formatNumber(participants);
            document.getElementById('pk-participants').textContent = formatNumber(participants - 3000);
            showPage('page-home');
        }
        
        function goToPrecisionForm() {
            if (!currentGame) {
                showToast('è¯·å…ˆé€‰æ‹©æ¸¸æˆ');
                return;
            }
            
            // Set game fields
            document.getElementById('game-fields').innerHTML = gameFields[currentGame] || '';
            
            // Set game name in header
            const gameNames = { wangzhe: 'ç‹è€…è£è€€', heping: 'å’Œå¹³ç²¾è‹±', sanjiao: 'ä¸‰è§’æ´²è¡ŒåŠ¨' };
            document.querySelector('#page-precision .pk-subtitle').textContent = gameNames[currentGame] || '';
            
            showPage('page-precision');
        }
        
        function goToShare() {
            showPage('page-share');
        }
        
        // Game selection
        function selectGame(game) {
            currentGame = game;
            
            // Random sample
            const gameSamples = samples[game] || samples.wangzhe;
            currentSample = gameSamples[Math.floor(Math.random() * gameSamples.length)];
            
            // Update price range
            const minPrice = Math.floor(currentSample.price * 0.5);
            const maxPrice = Math.floor(currentSample.price * 1.5);
            document.getElementById('price-range').textContent = `${minPrice} - ${maxPrice}`;
            
            // Display account info
            document.getElementById('account-desc').textContent = currentSample.desc;
            
            showPage('page-pk');
        }
        
        // Option selection in forms
        function selectOption(el, field, value) {
            const parent = el.parentElement;
            parent.querySelectorAll('.form-option').forEach(o => o.classList.remove('selected'));
            el.classList.add('selected');
        }
        
        function toggleHeroSkin(el, skin) {
            el.classList.toggle('selected');
        }
        
        // Submit PK
        function submitPK() {
            const userPrice = parseFloat(document.getElementById('user-price').value);
            
            if (!userPrice || userPrice <= 0) {
                showToast('è¯·è¾“å…¥æœ‰æ•ˆä»·æ ¼');
                return;
            }
            
            const aiPrice = currentSample.price;
            const diff = Math.abs(userPrice - aiPrice) / aiPrice * 100;
            
            // Calculate reward
            let reward, emoji, title, analysis, diffClass, diffText;
            if (diff <= 5) {
                reward = '50å…ƒæ— é—¨æ§›åˆ¸';
                emoji = 'ğŸ‰';
                title = 'å¤ªå‡†äº†ï¼';
                analysis = 'ä½ çš„ä¼°ä»·èƒ½åŠ›è¶…è¶Šäº† 99% çš„ç©å®¶ï¼';
                diffClass = '#00C853';
                diffText = `å·®å¼‚ï¼š${diff.toFixed(1)}%`;
            } else if (diff <= 10) {
                reward = '30å…ƒæ— é—¨æ§›åˆ¸';
                emoji = 'ğŸ‘';
                title = 'å¾ˆå‡†ï¼';
                analysis = 'ä½ çš„ä¼°ä»·èƒ½åŠ›è¶…è¶Šäº† 95% çš„ç©å®¶ï¼';
                diffClass = '#FFA726';
                diffText = `å·®å¼‚ï¼š${diff.toFixed(1)}%`;
            } else if (diff <= 20) {
                reward = '20å…ƒæ— é—¨æ§›åˆ¸';
                emoji = 'ğŸ˜Š';
                title = 'ä¸é”™ï¼';
                analysis = 'ä½ çš„ä¼°ä»·èƒ½åŠ›è¶…è¶Šäº† 80% çš„ç©å®¶ï¼';
                diffClass = '#FFB74D';
                diffText = `å·®å¼‚ï¼š${diff.toFixed(1)}%`;
            } else if (diff <= 30) {
                reward = '10å…ƒæ— é—¨æ§›åˆ¸';
                emoji = 'ğŸ’ª';
                title = 'è¿˜è¡Œï¼';
                analysis = 'ä½ çš„ä¼°ä»·èƒ½åŠ›è¶…è¶Šäº† 60% çš„ç©å®¶ï¼';
                diffClass = '#FFCC80';
                diffText = `å·®å¼‚ï¼š${diff.toFixed(1)}%`;
            } else {
                reward = '5å…ƒæ— é—¨æ§›åˆ¸';
                emoji = 'ğŸ˜…';
                title = 'å·®ä¸€ç‚¹ï¼';
                analysis = `å®é™…ä»·æ ¼æ˜¯ Â¥${aiPrice}ï¼Œå†è¯•ä¸€æ¬¡çœ‹çœ‹ï¼`;
                diffClass = '#FF5252';
                diffText = `å·®å¼‚ï¼š${diff.toFixed(1)}%`;
            }
            
            // Store result
            pkResult = { userPrice, aiPrice, diff, reward, emoji, title, analysis, diffClass, diffText };
            
            // Update result page
            document.getElementById('result-emoji').textContent = emoji;
            document.getElementById('result-title').textContent = title;
            document.getElementById('result-user').textContent = `Â¥${formatNumber(userPrice)}`;
            document.getElementById('result-ai').textContent = `Â¥${formatNumber(aiPrice)}`;
            document.getElementById('result-diff-badge').textContent = diffText;
            document.getElementById('result-diff-badge').style.background = diffClass;
            document.getElementById('result-diff-badge').style.color = '#fff';
            document.getElementById('result-coupon').textContent = `ğŸ ${reward}`;
            document.getElementById('analysis-text').textContent = analysis;
            
            // Update share page
            document.getElementById('share-user').textContent = `Â¥${formatNumber(userPrice)}`;
            document.getElementById('share-ai').textContent = `Â¥${formatNumber(aiPrice)}`;
            document.getElementById('share-coupon').textContent = `ğŸ å·®å¼‚${diff.toFixed(1)}% è·å¾— ${reward}`;
            
            // Set QR code
            document.getElementById('qr-image').src = 'images/qrcode.jpg';
            
            showPage('page-result');
        }
        
        // Submit precision form
        function submitPrecision() {
            const phone = document.getElementById('phone').value;
            
            if (!phone || phone.length < 11) {
                showToast('è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·');
                return;
            }
            
            // Calculate precision price based on form data
            let basePrice = 500;
            let details = [];
            
            // Get form values based on game
            if (currentGame === 'wangzhe') {
                const skinCount = parseInt(document.getElementById('skin-count')?.value) || 0;
                const legendCount = parseInt(document.getElementById('legend-count')?.value) || 0;
                const epicCount = parseInt(document.getElementById('epic-count')?.value) || 0;
                
                basePrice = 200 + skinCount * 3 + legendCount * 20 + epicCount * 50;
                details = [
                    { name: 'åŸºç¡€ä»·å€¼', value: 'Â¥200' },
                    { name: 'çš®è‚¤åŠ æˆ', value: `Â¥${skinCount * 3}` },
                    { name: 'ä¼ è¯´åŠ æˆ', value: `Â¥${legendCount * 20}` },
                    { name: 'æ— åŒå…¸è—', value: `Â¥${epicCount * 50}` }
                ];
            } else if (currentGame === 'heping') {
                const pinkCount = parseInt(document.getElementById('pink-count')?.value) || 0;
                const gunCount = parseInt(document.getElementById('gun-count')?.value) || 0;
                
                basePrice = 300 + pinkCount * 30 + gunCount * 50;
                details = [
                    { name: 'åŸºç¡€ä»·å€¼', value: 'Â¥300' },
                    { name: 'ç²‰è‰²å¥—è£…', value: `Â¥${pinkCount * 30}` },
                    { name: 'ç‰¹æ•ˆæª', value: `Â¥${gunCount * 50}` }
                ];
            } else if (currentGame === 'sanjiao') {
                const asset = parseInt(document.getElementById('asset')?.value) || 0;
                const gunskin = document.querySelector('#page-precision input[id="gun-count"]')?.parentElement?.querySelector('.selected')?.textContent === 'æœ‰';
                
                basePrice = asset * 2 + 200;
                details = [
                    { name: 'èµ„äº§ä»·å€¼', value: `Â¥${asset * 2}` },
                    { name: 'åŸºç¡€ä»·å€¼', value: 'Â¥200' }
                ];
            }
            
            const minPrice = Math.floor(basePrice * 0.9);
            const maxPrice = Math.floor(basePrice * 1.1);
            
            precisionResult = {
                minPrice,
                maxPrice,
                phone,
                details,
                formattedPhone: phone.substring(0, 3) + '********'
            };
            
            // Update precision result page
            document.getElementById('precision-price').textContent = `Â¥${formatNumber(minPrice)} - ${formatNumber(maxPrice)}`;
            document.getElementById('precision-sent').textContent = `ä¼°ä»·å·²å‘é€è‡³ ${precisionResult.formattedPhone}`;
            
            // Build details HTML
            const detailsHtml = precisionResult.details.map(d => `
                <div class="detail-item">
                    <span>${d.name}</span>
                    <span>${d.value}</span>
                </div>
            `).join('');
            document.getElementById('precision-details').innerHTML = detailsHtml;
            
            showPage('page-precision-result');
        }
        
        // Share functions
        function saveShareImage() {
            const canvas = document.getElementById('shareCanvas');
            const ctx = canvas.getContext('2d');
            
            // Background
            const gradient = ctx.createLinearGradient(0, 0, 0, 600);
            gradient.addColorStop(0, '#1a1a2e');
            gradient.addColorStop(1, '#2d2d44');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 375, 600);
            
            // Title
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 22px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('ğŸ† ä¼°ä»·æŒ‘æˆ˜èµ›', 187, 50);
            
            // Result
            ctx.fillStyle = '#ffffff';
            ctx.font = '16px sans-serif';
            ctx.fillText(`æˆ‘çš„ä¼°ä»·ï¼šÂ¥${formatNumber(pkResult.userPrice)}`, 187, 100);
            ctx.fillText(`AIä¼°ä»·ï¼šÂ¥${formatNumber(pkResult.aiPrice)}`, 187, 130);
            
            // Diff and reward
            ctx.fillStyle = '#FFD700';
            ctx.font = 'bold 18px sans-serif';
            ctx.fillText(`å·®å¼‚${pkResult.diff.toFixed(1)}% è·å¾— ${pkResult.reward}`, 187, 180);
            
            // Divider
            ctx.strokeStyle = 'rgba(255,255,255,0.2)';
            ctx.beginPath();
            ctx.moveTo(50, 210);
            ctx.lineTo(325, 210);
            ctx.stroke();
            
            // QR code placeholder
            const qrImg = new Image();
            qrImg.onload = function() {
                ctx.drawImage(qrImg, 112, 240, 150, 150);
                
                ctx.fillStyle = '#ffffff';
                ctx.font = '14px sans-serif';
                ctx.fillText('é•¿æŒ‰è¯†åˆ«äºŒç»´ç ', 187, 420);
                ctx.fillText('ä¸€èµ·æŒ‘æˆ˜é¢†åˆ¸ï¼', 187, 445);
                
                ctx.fillStyle = '#a0a0a0';
                ctx.font = '12px sans-serif';
                ctx.fillText('ä¼°ä»·ä»…ä¾›å‚è€ƒï¼Œä»¥å®¢æœéªŒå·ä¸ºå‡†', 187, 480);
                
                // Bottom decoration
                ctx.fillStyle = 'rgba(255,215,0,0.1)';
                ctx.fillRect(0, 520, 375, 80);
                
                // Save
                const link = document.createElement('a');
                link.download = 'ä¼°ä»·æŒ‘æˆ˜ç»“æœ.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                showToast('å›¾ç‰‡å·²ä¿å­˜');
            };
            qrImg.onerror = function() {
                // Draw placeholder if QR fails
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(112, 240, 150, 150);
                ctx.fillStyle = '#1a1a2e';
                ctx.font = '14px sans-serif';
                ctx.fillText('å®¢æœäºŒç»´ç ', 187, 315);
                
                const link = document.createElement('a');
                link.download = 'ä¼°ä»·æŒ‘æˆ˜ç»“æœ.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
                showToast('å›¾ç‰‡å·²ä¿å­˜');
            };
            qrImg.src = 'images/qrcode.jpg';
        }
        
        function shareToFriend() {
            // Native share API if available
            if (navigator.share) {
                canvas.toBlob(function(blob) {
                    const file = new File([blob], 'ä¼°ä»·æŒ‘æˆ˜ç»“æœ.png', { type: 'image/png' });
                    navigator.share({
                        title: 'ä¼°ä»·æŒ‘æˆ˜èµ›',
                        text: `æˆ‘ä¼°ä»·è·å¾—äº† ${pkResult.reward}ï¼Œå¿«æ¥æŒ‘æˆ˜ï¼`,
                        files: [file]
                    });
                });
            } else {
                showToast('è¯·ç‚¹å‡»"ä¿å­˜å›¾ç‰‡"ååˆ†äº«');
            }
        }
        
        // Utility functions
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }
        
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial participants
            participants = 12345 + Math.floor(Math.random() * 1000);
            document.getElementById('total-participants').textContent = formatNumber(participants);
            document.getElementById('pk-participants').textContent = formatNumber(participants - 3000);
        });
    </script>
</body>
</html>
